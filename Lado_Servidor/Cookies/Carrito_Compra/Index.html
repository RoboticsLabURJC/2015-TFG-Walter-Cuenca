<html>
  <head>
    <title>Ejemplo Carrito_Compra</title>
    <style type="text/css">
      div {
        /*border:solid;*/
        margin-top: 4px;
        margin:left; 
        width: 140px;
        height: 120px;
      }

      img{
        border:solid;
        width: 80px;
        height: 100px;
      }
      button{
        width: 40px;
        height: 20px;
      }
    </style>

    <script>
      var carrito;
      var user;
      console.log(document.cookie);
      /////////////////////////////////
      /// Iniciamos el carrito vacio //
      ////////////////////////////////
      function creat_Car(){
        console.log("creando carrito");
        carrito = [];
      }
      
      /////////////////////////////////
      /// Añadimos objeto al carrito //
      ////////////////////////////////
      
      function añadir(id){
        if(user != null){
          var elemento = document.getElementById(id);
          var compra = {user:user,name_libro:elemento.name,src:elemento.src};
          console.log(compra);
          carrito.push(compra);
          actualizar_cookie(carrito);
        }
      }
      
      //////////////////////////////////////////
      /// Actualizamos contenido con el server //
      //////////////////////////////////////////
      
      function actualizar_cookie(car){
        //envio por ajax el nuevo contenido del usuario 
       var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (xhttp.readyState == 4 && xhttp.status == 200) {
            //visualizamos el contenido actualizado de la cookie
              document.getElementById("view_car").innerHTML = document.cookie;
           }
        };
        xhttp.open("POST", "http://localhost:3000/", true);
        xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhttp.send(JSON.stringify(car));
      }
      
      //////////////////////////////////////////////////
      /// El nombre del usuario para realizar pruebas //
      /////////////////////////////////////////////////
      
      function new_user(){
         user = document.getElementById("name_user").value;
      }
    </script>
  </head>
  
  <body onload="creat_Car()">
    Nombre:<input type="text" id="name_user" onchange="new_user()">
    <br>
    <div>
      <img name="hulk" id="primer" src ="" alt="hulk"></img>
      <button onclick="añadir('primer')">Add</button>
    </div>
   <div>
      <img name ="curso fotografia" id="segundo" src ="" alt="curso fotografia"></img>
      <button onclick="añadir('segundo')">Add</button>
   </div>
    <div>
      <img name ="vengadores" id="tercero" src =""  alt="vengadores"></img>
      <button onclick="añadir('tercero')">Add</button>     
    </div>
    <div>
      <img name ="analisis" id="cuarto" src ="" alt="analisis"></img>
      <button type="button" onclick="añadir('cuarto')">Add</button>
    </div>
    <p id ="view_car"></p>
  </body>
<html>
